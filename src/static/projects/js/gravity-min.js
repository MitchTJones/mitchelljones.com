var cvs,ctx,mouseLoc=new Vector,planetAmount=100,starAmount=3,planets=[],gFactor=1,sFactors=[.9,1.1],lineStrengthMax=.75,lineStrengthMin=1e-6,Planet=function(){function t(t,e,s,a,n){this.loc=new Vector(t,e),this.speed=new Vector(0,0),this.radius=s,this.color=a,this.id=n}return t.prototype.move=function(){this.loc.add(this.speed)},t.prototype.addSpeed=function(t,e){this.speed.add(t,e)},t.prototype.setSpeed=function(t,e){this.speed.set(t,e)},t.prototype.shiftSpeed=function(t,e){this.speed.x=t*this.speed.x,this.speed.y=e*this.speed.y},t.prototype.display=function(){cEllipse(this.loc,this.radius,this.color)},t}();function setup(){onResize(),window.requestAnimationFrame(draw)}function onResize(){scaleCanvas(cvs,getWinSize()),ctx.translate(cvs.width/2,cvs.height/2),initialize()}function draw(){for(ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height),ctx.restore(),isReset&&(isReset=!1,reset()),p=0;p<planets.length;p++){for(_p=0;_p<planets.length;_p++)if(p!=_p){var t=grav(planets[p],planets[_p]).times(gFactor);planets[p].addSpeed(t)}planets[p].move(),planets[p].display()}window.setTimeout(window.requestAnimationFrame(draw))}function initialize(){for(planets=[],i=0;i<starAmount;i++)planets.push(new Planet(canvas.width/4-Math.random()*canvas.width/2,canvas.height/4-Math.random()*canvas.height/2,50+30*Math.random(),"#ffff00","star"));for(i=0;i<planetAmount;i++)planets.push(new Planet(canvas.width/2-Math.random()*canvas.width,canvas.height/2-Math.random()*canvas.height,1+15*Math.random(),"#ffffff","planet"))}function reset(){planets=[],initialize()}function coll(t,e){return t.speed.plus(e.speed.times(e.radius)).div(t.radius)}function grav(t,e){var s=new Vector(0,0);if(dist(t.loc,e.loc)>1){var a=dist(t.loc,e.loc),n=xDist(t.loc,e.loc),i=yDist(t.loc,e.loc),o=-Math.abs(n)/n*Math.sqrt(1-sq(i/a)),c=-Math.abs(i)/i*Math.sqrt(1-sq(n/a));s.set(o,c),s=(s=(s=s.times(sVolfromRad(e.radius))).div(sVolfromRad(t.radius))).div(sq(a))}return s}bare("canvas",setup,onResize),window.addEventListener("mousemove",function(t){var e=canvas.getBoundingClientRect();mouseLoc.set(t.clientX-e.left,t.clientY-e.top)}),window.addEventListener("keypress",function(t){var e=t.which;45==e&&ctx.scale(sFactors[0],sFactors[0]),61==e&&ctx.scale(sFactors[1],sFactors[1])});